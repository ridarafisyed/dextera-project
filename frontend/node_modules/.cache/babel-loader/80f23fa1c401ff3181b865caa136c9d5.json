{"ast":null,"code":"/** @format */\nimport axios from 'axios';\nimport { LOGIN_SUCCESS, LOGIN_FAIL, USER_LOADED_SUCCESS, USER_LOADED_FAIL, AUTHENTICATED_SUCCESS, AUTHENTICATED_FAIL, PASSWORD_RESET_SUCCESS, PASSWORD_RESET_FAIL, PASSWORD_RESET_CONFIRM_SUCCESS, PASSWORD_RESET_CONFIRM_FAIL, SIGNUP_SUCCESS, SIGNUP_FAIL, ACTIVATION_SUCCESS, ACTIVATION_FAIL, GOOGLE_AUTH_SUCCESS, GOOGLE_AUTH_FAIL, FACEBOOK_AUTH_SUCCESS, FACEBOOK_AUTH_FAIL, LOGOUT } from './types';\nimport { create_profile, get_profile } from './profile';\nexport const load_user = () => async dispatch => {\n  if (localStorage.getItem('access')) {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${localStorage.getItem('access')}`,\n        Accept: 'application/json'\n      }\n    };\n\n    try {\n      const res = await axios.get(`${process.env.REACT_APP_API_URL}/auth/users/me/`, config);\n      console.log('res.data load user :', res.data);\n      dispatch({\n        type: USER_LOADED_SUCCESS,\n        payload: res.data\n      });\n      dispatch(get_profile(res.data.username));\n    } catch (err) {\n      dispatch({\n        type: USER_LOADED_FAIL\n      });\n    }\n  } else {\n    dispatch({\n      type: USER_LOADED_FAIL\n    });\n  }\n};\nexport const checkAuthenticated = () => async dispatch => {\n  if (localStorage.getItem('access')) {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json'\n      }\n    };\n    const body = JSON.stringify({\n      token: localStorage.getItem('access')\n    });\n\n    try {\n      const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/jwt/verify/`, body, config);\n\n      if (res.data.code !== 'token_not_valid') {\n        dispatch({\n          type: AUTHENTICATED_SUCCESS\n        });\n      } else {\n        dispatch({\n          type: AUTHENTICATED_FAIL\n        });\n      }\n    } catch (err) {\n      dispatch({\n        type: AUTHENTICATED_FAIL\n      });\n    }\n  } else {\n    dispatch({\n      type: AUTHENTICATED_FAIL\n    });\n  }\n};\nexport const login = (email, password) => async dispatch => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  const body = JSON.stringify({\n    email,\n    password\n  });\n\n  try {\n    const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/jwt/create/`, body, config);\n    dispatch({\n      type: LOGIN_SUCCESS,\n      payload: res.data\n    });\n    dispatch(load_user());\n  } catch (err) {\n    dispatch({\n      type: LOGIN_FAIL\n    });\n  }\n};\nexport const signup = (email, first_name, last_name, username, password, re_password, is_firm, is_client) => async dispatch => {\n  const is_lawyer = false;\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  const body = JSON.stringify({\n    email,\n    first_name,\n    last_name,\n    username,\n    password,\n    re_password,\n    is_firm,\n    is_lawyer,\n    is_client\n  });\n\n  try {\n    const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/`, body, config);\n    dispatch({\n      type: SIGNUP_SUCCESS,\n      payload: res.data\n    });\n    dispatch(create_profile(username, email));\n  } catch (err) {\n    dispatch({\n      type: SIGNUP_FAIL\n    });\n  }\n};\nexport const verify = (uid, token) => async dispatch => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  const body = JSON.stringify({\n    uid,\n    token\n  });\n\n  try {\n    await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/activation/`, body, config);\n    dispatch({\n      type: ACTIVATION_SUCCESS\n    });\n  } catch (err) {\n    dispatch({\n      type: ACTIVATION_FAIL\n    });\n  }\n};\nexport const reset_password = email => async dispatch => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  const body = JSON.stringify({\n    email\n  });\n\n  try {\n    await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/reset_password/`, body, config);\n    dispatch({\n      type: PASSWORD_RESET_SUCCESS\n    });\n  } catch (err) {\n    dispatch({\n      type: PASSWORD_RESET_FAIL\n    });\n  }\n};\nexport const reset_password_confirm = (uid, token, new_password, re_new_password) => async dispatch => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  const body = JSON.stringify({\n    uid,\n    token,\n    new_password,\n    re_new_password\n  });\n\n  try {\n    await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/reset_password_confirm/`, body, config);\n    dispatch({\n      type: PASSWORD_RESET_CONFIRM_SUCCESS\n    });\n  } catch (err) {\n    dispatch({\n      type: PASSWORD_RESET_CONFIRM_FAIL\n    });\n  }\n};\nexport const logout = () => dispatch => {\n  dispatch({\n    type: LOGOUT\n  });\n};\nexport const googleAuthenticate = (state, code) => async dispatch => {\n  if (state && code && !localStorage.getItem('access')) {\n    const config = {\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }\n    };\n    const details = {\n      state: state,\n      code: code\n    };\n    const formBody = Object.keys(details).map(key => encodeURIComponent(key) + '=' + encodeURIComponent(details[key])).join('&');\n\n    try {\n      const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/o/google-oauth2/?${formBody}`, config);\n      dispatch({\n        type: GOOGLE_AUTH_SUCCESS,\n        payload: res.data\n      });\n      dispatch(load_user());\n    } catch (err) {\n      dispatch({\n        type: GOOGLE_AUTH_FAIL\n      });\n    }\n  }\n};\nexport const facebookAuthenticate = (state, code) => async dispatch => {\n  if (state && code && !localStorage.getItem('access')) {\n    const config = {\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }\n    };\n    const details = {\n      state: state,\n      code: code\n    };\n    const formBody = Object.keys(details).map(key => encodeURIComponent(key) + '=' + encodeURIComponent(details[key])).join('&');\n\n    try {\n      const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/o/facebook/?${formBody}`, config);\n      dispatch({\n        type: FACEBOOK_AUTH_SUCCESS,\n        payload: res.data\n      });\n      dispatch(load_user());\n    } catch (err) {\n      dispatch({\n        type: FACEBOOK_AUTH_FAIL\n      });\n    }\n  }\n};","map":{"version":3,"sources":["/home/supersis03/Projects/dextera-project/frontend/src/actions/auth.js"],"names":["axios","LOGIN_SUCCESS","LOGIN_FAIL","USER_LOADED_SUCCESS","USER_LOADED_FAIL","AUTHENTICATED_SUCCESS","AUTHENTICATED_FAIL","PASSWORD_RESET_SUCCESS","PASSWORD_RESET_FAIL","PASSWORD_RESET_CONFIRM_SUCCESS","PASSWORD_RESET_CONFIRM_FAIL","SIGNUP_SUCCESS","SIGNUP_FAIL","ACTIVATION_SUCCESS","ACTIVATION_FAIL","GOOGLE_AUTH_SUCCESS","GOOGLE_AUTH_FAIL","FACEBOOK_AUTH_SUCCESS","FACEBOOK_AUTH_FAIL","LOGOUT","create_profile","get_profile","load_user","dispatch","localStorage","getItem","config","headers","Authorization","Accept","res","get","process","env","REACT_APP_API_URL","console","log","data","type","payload","username","err","checkAuthenticated","body","JSON","stringify","token","post","code","login","email","password","signup","first_name","last_name","re_password","is_firm","is_client","is_lawyer","verify","uid","reset_password","reset_password_confirm","new_password","re_new_password","logout","googleAuthenticate","state","details","formBody","Object","keys","map","key","encodeURIComponent","join","facebookAuthenticate"],"mappings":"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","sourcesContent":["/** @format */\n\nimport axios from 'axios';\nimport {\n  LOGIN_SUCCESS,\n  LOGIN_FAIL,\n  USER_LOADED_SUCCESS,\n  USER_LOADED_FAIL,\n  AUTHENTICATED_SUCCESS,\n  AUTHENTICATED_FAIL,\n  PASSWORD_RESET_SUCCESS,\n  PASSWORD_RESET_FAIL,\n  PASSWORD_RESET_CONFIRM_SUCCESS,\n  PASSWORD_RESET_CONFIRM_FAIL,\n  SIGNUP_SUCCESS,\n  SIGNUP_FAIL,\n  ACTIVATION_SUCCESS,\n  ACTIVATION_FAIL,\n  GOOGLE_AUTH_SUCCESS,\n  GOOGLE_AUTH_FAIL,\n  FACEBOOK_AUTH_SUCCESS,\n  FACEBOOK_AUTH_FAIL,\n  LOGOUT,\n} from './types';\nimport { create_profile, get_profile } from './profile';\n\nexport const load_user = () => async (dispatch) => {\n  if (localStorage.getItem('access')) {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${localStorage.getItem('access')}`,\n        Accept: 'application/json',\n      },\n    };\n\n    try {\n      const res = await axios.get(\n        `${process.env.REACT_APP_API_URL}/auth/users/me/`,\n        config,\n      );\n      console.log('res.data load user :', res.data);\n      dispatch({\n        type: USER_LOADED_SUCCESS,\n        payload: res.data,\n      });\n      dispatch(get_profile(res.data.username));\n    } catch (err) {\n      dispatch({\n        type: USER_LOADED_FAIL,\n      });\n    }\n  } else {\n    dispatch({\n      type: USER_LOADED_FAIL,\n    });\n  }\n};\n\nexport const checkAuthenticated = () => async (dispatch) => {\n  if (localStorage.getItem('access')) {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n      },\n    };\n\n    const body = JSON.stringify({ token: localStorage.getItem('access') });\n\n    try {\n      const res = await axios.post(\n        `${process.env.REACT_APP_API_URL}/auth/jwt/verify/`,\n        body,\n        config,\n      );\n\n      if (res.data.code !== 'token_not_valid') {\n        dispatch({\n          type: AUTHENTICATED_SUCCESS,\n        });\n      } else {\n        dispatch({\n          type: AUTHENTICATED_FAIL,\n        });\n      }\n    } catch (err) {\n      dispatch({\n        type: AUTHENTICATED_FAIL,\n      });\n    }\n  } else {\n    dispatch({\n      type: AUTHENTICATED_FAIL,\n    });\n  }\n};\n\nexport const login = (email, password) => async (dispatch) => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json',\n    },\n  };\n\n  const body = JSON.stringify({ email, password });\n\n  try {\n    const res = await axios.post(\n      `${process.env.REACT_APP_API_URL}/auth/jwt/create/`,\n      body,\n      config,\n    );\n\n    dispatch({\n      type: LOGIN_SUCCESS,\n      payload: res.data,\n    });\n    dispatch(load_user());\n  } catch (err) {\n    dispatch({\n      type: LOGIN_FAIL,\n    });\n  }\n};\n\nexport const signup =\n  (\n    email,\n    first_name,\n    last_name,\n    username,\n    password,\n    re_password,\n    is_firm,\n    is_client,\n  ) =>\n  async (dispatch) => {\n    const is_lawyer = false;\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    };\n\n    const body = JSON.stringify({\n      email,\n      first_name,\n      last_name,\n      username,\n      password,\n      re_password,\n      is_firm,\n      is_lawyer,\n      is_client,\n    });\n\n    try {\n      const res = await axios.post(\n        `${process.env.REACT_APP_API_URL}/auth/users/`,\n        body,\n        config,\n      );\n      dispatch({\n        type: SIGNUP_SUCCESS,\n        payload: res.data,\n      });\n      dispatch(create_profile(username, email));\n    } catch (err) {\n      dispatch({\n        type: SIGNUP_FAIL,\n      });\n    }\n  };\n\nexport const verify = (uid, token) => async (dispatch) => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json',\n    },\n  };\n\n  const body = JSON.stringify({ uid, token });\n\n  try {\n    await axios.post(\n      `${process.env.REACT_APP_API_URL}/auth/users/activation/`,\n      body,\n      config,\n    );\n\n    dispatch({\n      type: ACTIVATION_SUCCESS,\n    });\n  } catch (err) {\n    dispatch({\n      type: ACTIVATION_FAIL,\n    });\n  }\n};\n\nexport const reset_password = (email) => async (dispatch) => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json',\n    },\n  };\n\n  const body = JSON.stringify({ email });\n\n  try {\n    await axios.post(\n      `${process.env.REACT_APP_API_URL}/auth/users/reset_password/`,\n      body,\n      config,\n    );\n\n    dispatch({\n      type: PASSWORD_RESET_SUCCESS,\n    });\n  } catch (err) {\n    dispatch({\n      type: PASSWORD_RESET_FAIL,\n    });\n  }\n};\n\nexport const reset_password_confirm =\n  (uid, token, new_password, re_new_password) => async (dispatch) => {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    };\n\n    const body = JSON.stringify({ uid, token, new_password, re_new_password });\n\n    try {\n      await axios.post(\n        `${process.env.REACT_APP_API_URL}/auth/users/reset_password_confirm/`,\n        body,\n        config,\n      );\n\n      dispatch({\n        type: PASSWORD_RESET_CONFIRM_SUCCESS,\n      });\n    } catch (err) {\n      dispatch({\n        type: PASSWORD_RESET_CONFIRM_FAIL,\n      });\n    }\n  };\n\nexport const logout = () => (dispatch) => {\n  dispatch({\n    type: LOGOUT,\n  });\n};\n\nexport const googleAuthenticate = (state, code) => async (dispatch) => {\n  if (state && code && !localStorage.getItem('access')) {\n    const config = {\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n    };\n\n    const details = {\n      state: state,\n      code: code,\n    };\n\n    const formBody = Object.keys(details)\n      .map(\n        (key) =>\n          encodeURIComponent(key) + '=' + encodeURIComponent(details[key]),\n      )\n      .join('&');\n\n    try {\n      const res = await axios.post(\n        `${process.env.REACT_APP_API_URL}/auth/o/google-oauth2/?${formBody}`,\n        config,\n      );\n\n      dispatch({\n        type: GOOGLE_AUTH_SUCCESS,\n        payload: res.data,\n      });\n\n      dispatch(load_user());\n    } catch (err) {\n      dispatch({\n        type: GOOGLE_AUTH_FAIL,\n      });\n    }\n  }\n};\n\nexport const facebookAuthenticate = (state, code) => async (dispatch) => {\n  if (state && code && !localStorage.getItem('access')) {\n    const config = {\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n    };\n\n    const details = {\n      state: state,\n      code: code,\n    };\n\n    const formBody = Object.keys(details)\n      .map(\n        (key) =>\n          encodeURIComponent(key) + '=' + encodeURIComponent(details[key]),\n      )\n      .join('&');\n\n    try {\n      const res = await axios.post(\n        `${process.env.REACT_APP_API_URL}/auth/o/facebook/?${formBody}`,\n        config,\n      );\n\n      dispatch({\n        type: FACEBOOK_AUTH_SUCCESS,\n        payload: res.data,\n      });\n\n      dispatch(load_user());\n    } catch (err) {\n      dispatch({\n        type: FACEBOOK_AUTH_FAIL,\n      });\n    }\n  }\n};\n"]},"metadata":{},"sourceType":"module"}